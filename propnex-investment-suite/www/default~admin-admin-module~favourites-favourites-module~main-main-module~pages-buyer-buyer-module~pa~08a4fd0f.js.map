{"version":3,"sources":["./src/app/services/place.service.ts"],"names":[],"mappings":"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","file":"default~admin-admin-module~favourites-favourites-module~main-main-module~pages-buyer-buyer-module~pa~08a4fd0f.js","sourcesContent":["import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { BehaviorSubject, of } from 'rxjs';\nimport { map, switchMap, take, tap } from 'rxjs/operators';\nimport { fbPostal, fbRec, fbUnit } from '../pages/auth/firebase.model';\nimport { Observable } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\n\nexport class PlaceService {\n\n  private _fbPostals = new BehaviorSubject<fbPostal[]>([]);\n  private _fbRecs = new BehaviorSubject<fbRec[]>([]);\n  private _currPlace: fbPostal;\n  private _currUnit: fbUnit;\n\n\n  get fbPostals() {\n    return this._fbPostals.asObservable();\n  }\n\n  get fbRecs() {\n    return this._fbRecs.asObservable();\n  }\n\n  get currPlace() {\n    return this._currPlace;\n  }\n\n  get currUnit() {\n    return this._currUnit;\n  }\n\n  set currPlace(currPlace: fbPostal) {\n    this._currPlace = currPlace;\n  }\n\n  set currUnit(currUnit: fbUnit) {\n    this._currUnit = currUnit;\n  }\n\n\n  constructor(\n    private http: HttpClient\n  ) { }\n\n  checkPostalCodeExists(postal: string): Observable<boolean> {\n    return this.fbPostals.pipe(\n      take(1),\n      map(postals => postals.some(place => place.postal === postal))\n    );\n  }\n\n\n  // fetch place data\n  fetchFBPostals() {\n    return this.http\n      .get(\n        `https://propnexpostals-37c08-default-rtdb.asia-southeast1.firebasedatabase.app/.json`\n      )\n      .pipe(\n        map(resData => {\n          const postals: fbPostal[] = [];\n          for (const key in resData) {\n            if (resData.hasOwnProperty(key)) {\n              postals.push(\n                new fbPostal(\n                  resData[key].name, \n                  resData[key].address, \n                  resData[key].postal,\n                  resData[key].landArea,\n                  resData[key].grossFloorArea,\n                  resData[key].tenure,\n                  resData[key].numRooms,\n                  resData[key].numStorey,\n                  resData[key].askingPrice,\n                  resData[key].priceRoom,\n                  resData[key].GFA,\n                  resData[key].roomRate,\n                  resData[key].netOperatingProfit,\n                  resData[key].approvedUsage,\n                  resData[key].region,\n                  resData[key].locationMRT,\n                  resData[key].locationSch,\n                  resData[key].district,\n                  resData[key].imageUrl,\n                  resData[key].units\n                )\n              );\n            }\n          }\n          return postals;\n        }),\n        tap(postals => {\n          this._fbPostals.next(postals);\n        })\n      );\n  }\n\n    // fetch place data\n    \n\n  fetchPlaceDetail(postalId: string) {\n    return this.fbPostals.pipe(\n      take(1),\n      map(postals => {\n        const foundPostal = postals.find(p => p.postal === postalId);\n        if (!foundPostal) {\n          throw new Error(`Postal with ID ${postalId} not found`);\n        }\n        return foundPostal;\n      }),\n      tap(currPlace => {\n        this._currPlace = currPlace; // Set the current place\n      }),\n    );\n  }\n\n  // fetch recommendation data\n  fetchFBRecs() {\n    return this.http\n      .get(\n        `https://propnexpostals-37c08-default-rtdb.asia-southeast1.firebasedatabase.app/.json`\n      )\n      .pipe(\n        map(resData => {\n          const places: fbRec[] = [];\n          for (const key in resData) {\n            if (resData.hasOwnProperty(key)) {\n              places.push(\n                new fbRec(\n                  resData[key].place, \n                  resData[key].rec1, \n                  resData[key].rec2,\n                  resData[key].rec3\n                )\n              );\n            }\n          }\n          return places;\n        }),\n        tap(places => {\n          this._fbRecs.next(places);\n        })\n      );\n  }\n\n  // add new place\n  addBlock(name: string, address: string, postal: string, landArea: Float32Array, grossFloorArea: Float32Array, tenure: string, numRooms: number, numStorey: Int16Array, askingPrice: number, priceRoom: Float32Array, GFA: string, roomRate: Float32Array, netOperatingProfit: Float32Array, approvedUsage: string, region: string, LocationMRT: string, LocationSch: string, district: string) {\n    const newBlock = new fbPostal(\n      name,\n      address,\n      postal,\n      landArea,\n      grossFloorArea,\n      tenure,\n      numRooms,\n      numStorey,\n      askingPrice,\n      priceRoom,\n      GFA,\n      roomRate,\n      netOperatingProfit,\n      approvedUsage,\n      region,\n      LocationMRT,\n      LocationSch,\n      district\n    );\n    return this.http\n      .post('https://propnexpostals-37c08-default-rtdb.asia-southeast1.firebasedatabase.app/.json',\n      { ...newBlock })\n      .pipe(\n        switchMap(resData => {\n          return this.fbPostals;\n        }),\n        take(1),\n        tap(fbUsers => {\n          this._fbPostals.next(fbUsers.concat(newBlock));\n        })\n      );\n  }\n\n  // edit existing place\n  editBlock(targetPostal: string, newName: string) {\n    let updatedUsers: fbPostal[];\n    return this.fbPostals.pipe(\n      take(1),\n      switchMap(users => {\n        if (!users || users.length <= 0) {\n          return this.fetchFBPostals();\n        } else {\n          return of(users);\n        }\n      }),\n      switchMap(users => {\n        const updatedUserIndex = users.findIndex(u => u.postal === targetPostal);\n        updatedUsers = [...users];\n        const oldPlace = updatedUsers[updatedUserIndex];\n        updatedUsers[updatedUserIndex] = new fbPostal(\n          newName,\n          oldPlace.address,\n          oldPlace.postal,\n          oldPlace.landArea,\n          oldPlace.grossFloorArea,\n          oldPlace.tenure,\n          oldPlace.numRooms,\n          oldPlace.numStorey,\n          oldPlace.askingPrice,\n          oldPlace.priceRoom,\n          oldPlace.GFA,\n          oldPlace.roomRate,\n          oldPlace.netOperatingProfit,\n          oldPlace.approvedUsage,\n          oldPlace.region,\n          oldPlace.locationMRT,\n          oldPlace.locationSch,\n          oldPlace.imageUrl\n        );\n        this.currPlace = updatedUsers[updatedUserIndex];\n        return this.http.put(\n          `https://propnexpostals-37c08-default-rtdb.asia-southeast1.firebasedatabase.app/${updatedUserIndex}.json`,\n          { ...updatedUsers[updatedUserIndex] }\n        );\n      }),\n      tap(() => {\n        this._fbPostals.next(updatedUsers);\n      })\n    );\n  }\n\n  // add new unit to existing place\n  addUnit(targetPostal: string, unitNumber: string, bedrooms: string, size: string, UnitFacing: string) {\n    let updatedPlaces: fbPostal[];\n    return this.fbPostals.pipe(\n      take(1),\n      switchMap(places => {\n        if (!places || places.length <= 0) {\n          return this.fetchFBPostals();\n        } else {\n          return of(places);\n        }\n      }),\n      switchMap(places => {\n        const updatedPlaceIndex = places.findIndex(p => p.postal === targetPostal);\n        updatedPlaces = [...places];\n        const oldPlace = updatedPlaces[updatedPlaceIndex];\n        const newUnit = new fbUnit(\n          bedrooms,\n          `assets/placeholders/floorplan.png`,\n          size,\n          unitNumber,\n          UnitFacing\n        );\n        let newUnitsArr = oldPlace.units || [];\n        newUnitsArr = newUnitsArr.concat(newUnit);\n        \n        updatedPlaces[updatedPlaceIndex] = new fbPostal(\n          oldPlace.name,\n          oldPlace.address,\n          oldPlace.postal,\n          oldPlace.landArea,\n          oldPlace.grossFloorArea,\n          oldPlace.tenure,\n          oldPlace.numRooms,\n          oldPlace.numStorey,\n          oldPlace.askingPrice,\n          oldPlace.priceRoom,\n          oldPlace.GFA,\n          oldPlace.roomRate,\n          oldPlace.netOperatingProfit,\n          oldPlace.approvedUsage,\n          oldPlace.region,\n          oldPlace.locationMRT,\n          oldPlace.locationSch,\n          oldPlace.district,\n          oldPlace.imageUrl,\n          newUnitsArr\n        );\n        this.currPlace = updatedPlaces[updatedPlaceIndex];\n        this.currUnit = newUnit;\n        return this.http.put(\n          `https://propnexpostals-37c08-default-rtdb.asia-southeast1.firebasedatabase.app/${updatedPlaceIndex}.json`,\n          { ...updatedPlaces[updatedPlaceIndex] }\n        );\n      }),\n      tap(() => {\n        this._fbPostals.next(updatedPlaces);\n      })\n    );\n  }\n\n  // edit existing unit in existing place\n  editUnit(targetPostal: string, targetUnitNum: string, newUnit: fbUnit) {\n    let updatedUsers: fbPostal[];\n    return this.fbPostals.pipe(\n      take(1),\n      switchMap(users => {\n        if (!users || users.length <= 0) {\n          return this.fetchFBPostals();\n        } else {\n          return of(users);\n        }\n      }),\n      switchMap(users => {\n        const updatedUserIndex = users.findIndex(u => u.postal === targetPostal);\n        updatedUsers = [...users];\n        const oldPlace = updatedUsers[updatedUserIndex];\n        const oldUnitIndex = oldPlace.units.findIndex(u => u.unitNumber === targetUnitNum);\n        oldPlace.units[oldUnitIndex] = newUnit;\n        let newFavArr = oldPlace.units;\n        updatedUsers[updatedUserIndex] = new fbPostal(\n          oldPlace.name,\n          oldPlace.address,\n          oldPlace.postal,\n          oldPlace.landArea,\n          oldPlace.grossFloorArea,\n          oldPlace.tenure,\n          oldPlace.numRooms,\n          oldPlace.numStorey,\n          oldPlace.askingPrice,\n          oldPlace.priceRoom,\n          oldPlace.GFA,\n          oldPlace.roomRate,\n          oldPlace.netOperatingProfit,\n          oldPlace.approvedUsage,\n          oldPlace.region,\n          oldPlace.locationMRT,\n          oldPlace.locationSch,\n          oldPlace.district,\n          oldPlace.imageUrl,\n          newFavArr\n        );\n        this.currPlace = updatedUsers[updatedUserIndex];\n        this.currUnit = newUnit;\n        return this.http.put(\n          `https://propnexpostals-37c08-default-rtdb.asia-southeast1.firebasedatabase.app/${updatedUserIndex}.json`,\n          { ...updatedUsers[updatedUserIndex] }\n        );\n      }),\n      tap(() => {\n        this._fbPostals.next(updatedUsers);\n      })\n    );\n  }\n\n  // edit all existing units with same unit number in existing place\n  editAllUnit(targetPostal: string, targetUnitNum: string, newBedrooms: string, newSize: string) {\n    let updatedUsers: fbPostal[];\n    return this.fbPostals.pipe(\n      take(1),\n      switchMap(users => {\n        if (!users || users.length <= 0) {\n          return this.fetchFBPostals();\n        } else {\n          return of(users);\n        }\n      }),\n      switchMap(users => {\n        const updatedUserIndex = users.findIndex(u => u.postal === targetPostal);\n        updatedUsers = [...users];\n        const oldPlace = updatedUsers[updatedUserIndex];\n\n        let targetString = '-' + targetUnitNum.split('-')[1];\n        let unitArr = oldPlace.units.filter(u => u.unitNumber.includes(targetString));\n\n        unitArr.forEach(u => {\n          u.bedrooms = newBedrooms;\n          u.size = newSize;\n        });\n\n        for (let i = 0; i < unitArr.length; i++) {\n          let currUnitNum = unitArr[i].unitNumber;\n          let currIndex = oldPlace.units.findIndex(u => u.unitNumber === currUnitNum);\n          oldPlace.units[currIndex] = unitArr[i];\n        }\n        \n        const oldUnitIndex = oldPlace.units.findIndex(u => u.unitNumber === targetUnitNum);\n\n        updatedUsers[updatedUserIndex] = new fbPostal(\n          oldPlace.name,\n          oldPlace.address,\n          oldPlace.postal,\n          oldPlace.landArea,\n          oldPlace.grossFloorArea,\n          oldPlace.tenure,\n          oldPlace.numRooms,\n          oldPlace.numStorey,\n          oldPlace.askingPrice,\n          oldPlace.priceRoom,\n          oldPlace.GFA,\n          oldPlace.roomRate,\n          oldPlace.netOperatingProfit,\n          oldPlace.approvedUsage,\n          oldPlace.region,\n          oldPlace.locationMRT,\n          oldPlace.locationSch,\n          oldPlace.district,\n          oldPlace.imageUrl,\n          oldPlace.units\n        );\n        this.currPlace = updatedUsers[updatedUserIndex];\n        this.currUnit = oldPlace.units[oldUnitIndex];\n        return this.http.put(\n          `https://propnexpostals-37c08-default-rtdb.asia-southeast1.firebasedatabase.app/${updatedUserIndex}.json`,\n          { ...updatedUsers[updatedUserIndex] }\n        );\n      }),\n      tap(() => {\n        this._fbPostals.next(updatedUsers);\n      })\n    );\n  }\n}\n"],"sourceRoot":"webpack:///"}